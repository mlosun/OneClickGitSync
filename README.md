# 一键同步多个 Git 仓库

自动扫描指定目录下的 Git 仓库，一键执行同步

## 功能特点

- **自动扫描**：自动识别目录下的 Git 仓库
- **一键同步**：批量执行 pull → commit → push
- **跨平台**：支持 macOS 和 Windows
- **日志记录**：详细记录同步过程和错误信息

## 快速开始

### 1. 配置路径

复制示例配置文件：

```bash
cp .env.example .env
```

编辑 `.env` 文件，设置扫描路径：

```bash
# macOS
MACOS_PATH=/Users/yourname/dev

# Windows
WINDOWS_PATH=D:\Projects
```

### 2. 运行脚本

```bash
python sync.py
```

## 工作流程

1. 扫描指定目录下的所有子文件夹
2. 识别其中的 Git 仓库（检查 `.git` 目录）
3. 对每个仓库执行：
   - `git pull --rebase` 拉取更新
   - 检测本地改动，有改动则自动提交
   - `git push` 推送更新
4. 任何步骤失败会记录详细错误并继续处理下一个仓库

## 日志文件

- 位置：`logs/sync_YYYYMMDD.log`
- 格式：`[月-日 时:分:秒] 消息`
- 自动按日期归档

## 自动执行

### macOS（crontab）

```bash
crontab -e
```

添加定时任务：

```cron
# 每天 8:00 和 20:00 执行
0 8,20 * * * /usr/bin/python3 /完整路径/sync.py
```

### Windows（任务计划程序）

1. `Win + R` → 输入 `taskschd.msc`
2. 创建基本任务
3. 设置触发器（如：每天）
4. 设置操作：
   - 程序：`python`
   - 参数：`C:\完整路径\sync.py`

## 常见问题

### Q: 仓库拉取失败？

可能原因：
- 有未提交的本地改动（无法 rebase）
- 网络连接问题
- 权限或认证问题

**解决**：手动处理冲突或检查网络/权限配置

### Q: 推送失败？

可能原因：
- 网络连接问题
- 无推送权限
- SSH 密钥未配置

**解决**：检查网络、权限或 SSH 配置

### Q: 如何跳过某个仓库？

将仓库从扫描目录移出，或重命名文件夹名

## 文件说明

- `sync.py` - 主脚本
- `.env` - 路径配置文件（需创建）
- `.env.example` - 配置示例
- `logs/` - 日志目录（自动创建）

---

> 提示：首次使用建议先用测试仓库验证配置，再应用到生产环境